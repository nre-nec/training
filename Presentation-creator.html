<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุดุฆ ุงูุนุฑูุถ ุงูุชูุฏูููุฉ - ูููุฉ ุงูุดูุงู</title>
    <link rel="icon" href="https://nre-nec.github.io/pictures/logo.png" type="image/png">
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap');
        
        body { font-family: 'Cairo', sans-serif; background-color: #f3f4f6; }
        
        .text-primary { color: #5D4068; }
        .bg-primary { background-color: #5D4068; }
        .text-secondary { color: #C5B358; }
        .bg-secondary { background-color: #C5B358; }
        .border-primary { border-color: #5D4068; }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { motion, AnimatePresence } = window.Motion;

        const Icons = {
            Plus: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>,
            Trash: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>,
            Play: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>,
            Edit: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>,
            Close: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
            Right: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m9 18 6-6-6-6"/></svg>,
            Left: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m15 18-6-6 6-6"/></svg>,
            Download: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>,
            Help: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/></svg>,
            Image: () => <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>,
            // Heroicons - ูุฎุชุงุฑุฉ ุจุนูุงูุฉ
            Star: (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props?.size || 24} height={props?.size || 24} viewBox="0 0 24 24" fill="currentColor"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>,
            TrendingUp: (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props?.size || 24} height={props?.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 17"/><polyline points="17 6 23 6 23 12"/></svg>,
            Users: (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props?.size || 24} height={props?.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
            Award: (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props?.size || 24} height={props?.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="8" r="7"/><polyline points="8 14 12 17 16 14"/><line x1="12" y1="17" x2="12" y2="23"/><line x1="9" y1="20" x2="15" y2="20"/></svg>,
            Zap: (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props?.size || 24} height={props?.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
            Target: (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props?.size || 24} height={props?.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="1"/><circle cx="12" cy="12" r="5"/><circle cx="12" cy="12" r="9"/></svg>,
            Rocket: (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props?.size || 24} height={props?.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4.5 16.5c-1.5-1.5-2-5-2-5s3.5-.5 5-2l.5.5-.5.5c1.5 1.5 1 4 .5 5.5"/><path d="M12 6v6m6-6v6"/><circle cx="12" cy="12" r="10"/></svg>,
            Lightbulb: (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props?.size || 24} height={props?.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 18h6m-9-2h12a2 2 0 0 0 1.697-3.153l-.653-1.306a2 2 0 0 1-.221-1.126V7a4 4 0 0 0-8 0v3.415a2 2 0 0 1-.221 1.126l-.653 1.306A2 2 0 0 0 6 16z"/></svg>,
            CheckCircle: (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props?.size || 24} height={props?.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
            Heart: (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props?.size || 24} height={props?.size || 24} viewBox="0 0 24 24" fill="currentColor"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>,
            GraduationCap: (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props?.size || 24} height={props?.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 19V5c0-1-1-2-2-2H5c-1 0-2 1-2 2v14m20 0l-9-7-9 7m14-3v5m-8 0v5"/></svg>,
            BookOpen: (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props?.size || 24} height={props?.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2zM22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>,
            Briefcase: (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props?.size || 24} height={props?.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 7V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2"/></svg>,
            BarChart3: (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props?.size || 24} height={props?.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="20" x2="12" y2="10"/><line x1="18" y1="20" x2="18" y2="4"/><line x1="6" y1="20" x2="6" y2="16"/></svg>
        };

        const HeroiconsList = [
            { id: 'star', name: 'โญ ูุฌูุฉ', icon: 'Star' },
            { id: 'trending', name: '๐ ููู', icon: 'TrendingUp' },
            { id: 'users', name: '๐ฅ ูุฑูู', icon: 'Users' },
            { id: 'award', name: '๐ ุฅูุฌุงุฒ', icon: 'Award' },
            { id: 'zap', name: 'โก ุณุฑูุน', icon: 'Zap' },
            { id: 'target', name: '๐ฏ ูุฏู', icon: 'Target' },
            { id: 'rocket', name: '๐ ุงูุทูุงู', icon: 'Rocket' },
            { id: 'lightbulb', name: '๐ก ููุฑุฉ', icon: 'Lightbulb' },
            { id: 'check', name: 'โ ููุงููุฉ', icon: 'CheckCircle' },
            { id: 'heart', name: 'โค๏ธ ูููุฉ', icon: 'Heart' },
            { id: 'graduation', name: '๐ ุชุนููู', icon: 'GraduationCap' },
            { id: 'book', name: '๐ ูุนุฑูุฉ', icon: 'BookOpen' },
            { id: 'briefcase', name: '๐ผ ุนูู', icon: 'Briefcase' },
            { id: 'chart', name: '๐ ุจูุงูุงุช', icon: 'BarChart3' }
        ];

        const initialSlides = [
            {
                id: 1,
                title: "ุฑุคูุฉ ุงููููุฉ ูุงูุชููุฒ",
                content: "โข ุงูุฑูุงุฏุฉ ูู ุชูุฏูู ุชุนููู ุชูุฑูุถู ูุจุชูุฑ.\nโข ุชุฎุฑูุฌ ููุงุฏุฑ ูุทููุฉ ูุคููุฉ.\nโข ุจูุฆุฉ ุชุนููููุฉ ูุญูุฒุฉ.",
                image: "",
                slideIcon: "star",
                modalTitle: "ูุตุฉ ูุฌุงุญ",
                modalContent: "ุชู ุชุฎุฑูุฌ 300 ุทุงูุจ ูุทุงูุจุฉ ูุฐุง ุงูุนุงู ุจูุณุจุฉ ุชูุธูู ุจูุบุช 95%."
            },
            {
                id: 2,
                title: "ุงูุฅุญุตุงุฆูุงุช ูุงูุฃุฑูุงู",
                content: "โข ูุณุจุฉ ุฑุถุง ุงูุทูุงุจ: 98%\nโข ุนุฏุฏ ุงูุดุฑุงูุงุช: 15 ูุณุชุดูู\nโข ุงูุงุนุชูุงุฏุงุช: 3 ุงุนุชูุงุฏุงุช ุฏูููุฉ",
                image: "https://placehold.co/600x400/5D4068/FFF?text=Chart",
                slideIcon: "chart",
                modalTitle: "ุชูุงุตูู ุงูุฑุณู ุงูุจูุงูู",
                modalContent: "ููุถุญ ุงูุฑุณู ุงูุจูุงูู ุงูููู ุงููุชุตุงุนุฏ ูู ุฃุนุฏุงุฏ ุงูููุจูููู."
            }
        ];

        function App() {
            const [mode, setMode] = useState('editor');
            const [slides, setSlides] = useState(initialSlides);
            const [currentSlideIndex, setCurrentSlideIndex] = useState(0);
            const [showModal, setShowModal] = useState(false);
            const [showHelp, setShowHelp] = useState(false);

            const addNewSlide = () => {
                const newId = Math.max(...slides.map(s => s.id), 0) + 1;
                setSlides([...slides, { 
                    id: newId, 
                    title: "ุดุฑูุญุฉ ุฌุฏูุฏุฉ", 
                    content: "ุงูุชุจ ุงูููุงุท ููุง...", 
                    image: "", 
                    slideIcon: "star",
                    modalTitle: "ุนููุงู ุงููุซุงู", 
                    modalContent: "ุชูุงุตูู ุงููุซุงู..." 
                }]);
            };

            const updateSlide = (id, field, value) => {
                setSlides(slides.map(s => s.id === id ? { ...s, [field]: value } : s));
            };

            const deleteSlide = (id) => {
                if (slides.length > 1) {
                    setSlides(slides.filter(s => s.id !== id));
                    if (currentSlideIndex >= slides.length - 1) {
                        setCurrentSlideIndex(Math.max(0, slides.length - 2));
                    }
                }
            };

            const nextSlide = () => {
                if (currentSlideIndex < slides.length - 1) setCurrentSlideIndex(prev => prev + 1);
                else setCurrentSlideIndex(0);
            };

            const prevSlide = () => {
                if (currentSlideIndex > 0) setCurrentSlideIndex(prev => prev - 1);
                else setCurrentSlideIndex(slides.length - 1);
            };

            const downloadPresentation = () => {
                const htmlContent = generateStandaloneHTML();
                const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'presentation.html';
                link.click();
            };

            const generateStandaloneHTML = () => {
                return `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุนุฑุถ ุชูุฏููู - ูููุฉ ุงูุดูุงู</title>
    <link rel="icon" href="https://nre-nec.github.io/pictures/logo.png" type="image/png">
    <script src="https://cdn.tailwindcss.com"><\/script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"><\/script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap');
        body { font-family: 'Cairo', sans-serif; }
        .text-primary { color: #5D4068; }
        .bg-primary { background-color: #5D4068; }
        .text-secondary { color: #C5B358; }
        .bg-secondary { background-color: #C5B358; }
        .border-primary { border-color: #5D4068; }
    </style>
</head>
<body>
    <div id="root" class="relative w-full h-screen overflow-hidden bg-white flex flex-col">
        <img src="https://nre-nec.github.io/pictures/logo.png" alt="Logo" class="fixed top-5 left-5 w-24 z-50 drop-shadow-md" />
        <button id="exitBtn" class="fixed top-5 right-5 z-50 bg-gray-200 p-2 rounded-full hover:bg-gray-300">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>
        </button>

        <div class="flex-1 flex items-center justify-center p-4 relative" id="slideContainer">
            <!-- Slide will be inserted here -->
        </div>

        <div class="flex items-center justify-center gap-4 py-4 bg-gray-50 border-t">
            <span id="slideCounter" class="text-sm text-gray-600 font-medium"></span>
            <div class="h-2 bg-gray-200 flex-1" id="progressBar">
                <div class="h-full bg-secondary" id="progressFill" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <script>
        const slidesData = ${JSON.stringify(slides)};
        const HeroiconsList = ${JSON.stringify(HeroiconsList)};
        
        let currentIndex = 0;

        const Icons = {
            Right: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>',
            Left: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>',
            Close: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>'
        };

        const heroIcons = {
            'star': '<svg width="56" height="56" viewBox="0 0 24 24" fill="currentColor"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>',
            'trending': '<svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 17"/><polyline points="17 6 23 6 23 12"/></svg>',
            'users': '<svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>',
            'award': '<svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="8" r="7"/><polyline points="8 14 12 17 16 14"/><line x1="12" y1="17" x2="12" y2="23"/><line x1="9" y1="20" x2="15" y2="20"/></svg>',
            'zap': '<svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>',
            'target': '<svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"/><circle cx="12" cy="12" r="5"/><circle cx="12" cy="12" r="9"/></svg>',
            'rocket': '<svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4.5 16.5c-1.5-1.5-2-5-2-5s3.5-.5 5-2l.5.5-.5.5c1.5 1.5 1 4 .5 5.5"/><path d="M12 6v6m6-6v6"/><circle cx="12" cy="12" r="10"/></svg>',
            'lightbulb': '<svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18h6m-9-2h12a2 2 0 0 0 1.697-3.153l-.653-1.306a2 2 0 0 1-.221-1.126V7a4 4 0 0 0-8 0v3.415a2 2 0 0 1-.221 1.126l-.653 1.306A2 2 0 0 0 6 16z"/></svg>',
            'check': '<svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>',
            'heart': '<svg width="56" height="56" viewBox="0 0 24 24" fill="currentColor"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>',
            'graduation': '<svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 19V5c0-1-1-2-2-2H5c-1 0-2 1-2 2v14m20 0l-9-7-9 7m14-3v5m-8 0v5"/></svg>',
            'book': '<svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2zM22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>',
            'briefcase': '<svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 7V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2"/></svg>',
            'chart': '<svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="20" x2="12" y2="10"/><line x1="18" y1="20" x2="18" y2="4"/><line x1="6" y1="20" x2="6" y2="16"/></svg>'
        };

        function renderSlide(index) {
            const slide = slidesData[index];
            const progress = ((index + 1) / slidesData.length) * 100;
            
            const iconSvg = heroIcons[slide.slideIcon] || '<span class="text-6xl text-secondary">โฆ</span>';
            
            const slideHTML = \`
                <div class="w-full max-w-6xl bg-white rounded-3xl shadow-2xl overflow-hidden border-t-8 border-primary flex flex-col md:flex-row" style="min-height: 70vh">
                    <div class="\${slide.image ? 'md:w-1/2' : 'w-full text-center'} p-10 flex flex-col justify-center">
                        <div class="mb-6">
                            <div class="text-6xl mb-3 text-secondary">\${iconSvg}</div>
                            <h1 class="text-4xl md:text-5xl font-black text-primary">\${slide.title}</h1>
                        </div>
                        <div class="text-xl md:text-2xl text-gray-600 leading-relaxed whitespace-pre-line mb-8">
                            \${slide.content}
                        </div>
                        <div class="\${!slide.image ? 'mx-auto' : ''} mt-auto">
                            <button onclick="showModal()" class="bg-primary text-white px-8 py-3 rounded-full text-lg shadow-lg flex items-center gap-2 hover:bg-[#4a3252]">
                                <span>ูุซุงู ุนููู</span>
                                \${Icons.Left}
                            </button>
                        </div>
                    </div>
                    \${slide.image ? \`
                        <div class="md:w-1/2 bg-gray-100 flex items-center justify-center p-4 border-r border-gray-200">
                            <img src="\${slide.image}" alt="Visual" class="max-w-full max-h-[500px] object-contain rounded-lg shadow-sm" />
                        </div>
                    \` : ''}
                </div>

                <button onclick="prevSlide()" class="absolute right-4 top-1/2 -translate-y-1/2 p-4 bg-white/80 rounded-full shadow-lg hover:bg-primary hover:text-white transition hidden md:block">
                    \${Icons.Right}
                </button>
                <button onclick="nextSlide()" class="absolute left-4 top-1/2 -translate-y-1/2 p-4 bg-white/80 rounded-full shadow-lg hover:bg-primary hover:text-white transition hidden md:block">
                    \${Icons.Left}
                </button>

                <div id="modalOverlay" class="fixed inset-0 bg-primary/90 z-[100] flex items-center justify-center p-4 backdrop-blur-sm hidden" onclick="closeModal()">
                    <div class="bg-white w-full max-w-lg rounded-2xl p-8 shadow-2xl relative text-center" onclick="event.stopPropagation()">
                        <button onclick="closeModal()" class="absolute top-4 left-4 text-gray-400 hover:text-red-500">
                            \${Icons.Close}
                        </button>
                        <h2 class="text-3xl font-bold text-primary mb-4">\${slide.modalTitle}</h2>
                        <div class="text-lg text-gray-600 bg-gray-50 p-4 rounded-xl border-r-4 border-secondary max-h-96 overflow-y-auto">
                            \${slide.modalContent}
                        </div>
                    </div>
                </div>
            \`;
            
            document.getElementById('slideContainer').innerHTML = slideHTML;
            document.getElementById('slideCounter').textContent = \`ุงูุดุฑูุญุฉ \${index + 1} ูู \${slidesData.length}\`;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function nextSlide() {
            currentIndex = (currentIndex + 1) % slidesData.length;
            renderSlide(currentIndex);
        }

        function prevSlide() {
            currentIndex = (currentIndex - 1 + slidesData.length) % slidesData.length;
            renderSlide(currentIndex);
        }

        function showModal() {
            document.getElementById('modalOverlay').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('modalOverlay').classList.add('hidden');
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') nextSlide();
            if (e.key === 'ArrowRight') prevSlide();
            if (e.key === 'Escape') closeModal();
        });

        document.getElementById('exitBtn').addEventListener('click', () => {
            window.close();
        });

        renderSlide(0);
    <\/script>
</body>
</html>`;
            };

            useEffect(() => {
                const handleKeyDown = (e) => {
                    if (mode === 'presentation') {
                        if (e.key === 'ArrowLeft') nextSlide();
                        if (e.key === 'ArrowRight') prevSlide();
                        if (e.key === 'Escape') setMode('editor');
                    }
                };
                window.addEventListener('keydown', handleKeyDown);
                return () => window.removeEventListener('keydown', handleKeyDown);
            }, [mode, currentSlideIndex, slides.length]);

            if (mode === 'presentation') {
                const slide = slides[currentSlideIndex];
                const progress = ((currentSlideIndex + 1) / slides.length) * 100;

                return (
                    <div className="relative w-full h-screen overflow-hidden bg-white flex flex-col">
                        <img src="https://nre-nec.github.io/pictures/logo.png" alt="Logo" className="fixed top-5 left-5 w-24 z-50 drop-shadow-md" />
                        
                        <button onClick={() => setMode('editor')} className="fixed top-5 right-5 z-50 bg-gray-200 p-2 rounded-full hover:bg-gray-300">
                            <Icons.Edit />
                        </button>

                        <div className="flex-1 flex items-center justify-center p-4 relative">
                            <AnimatePresence mode="wait">
                                <motion.div 
                                    key={slide.id}
                                    initial={{ opacity: 0, x: 50 }}
                                    animate={{ opacity: 1, x: 0 }}
                                    exit={{ opacity: 0, x: -50 }}
                                    transition={{ duration: 0.5 }}
                                    className={`w-full max-w-6xl bg-white rounded-3xl shadow-2xl overflow-hidden border-t-8 border-primary flex flex-col md:flex-row`}
                                    style={{ minHeight: '70vh' }}
                                >
                                    <div className={`p-10 flex flex-col justify-center ${slide.image ? 'md:w-1/2' : 'w-full text-center'}`}>
                                        <div className="mb-6">
                                            <div className="text-6xl mb-3 text-secondary">
                                                {slide.slideIcon && Icons[HeroiconsList.find(i => i.id === slide.slideIcon)?.icon] 
                                                    ? React.createElement(Icons[HeroiconsList.find(i => i.id === slide.slideIcon)?.icon], { size: 56 }) 
                                                    : <span>โฆ</span>
                                                }
                                            </div>
                                            <h1 className="text-4xl md:text-5xl font-black text-primary">{slide.title}</h1>
                                        </div>
                                        <div className="text-xl md:text-2xl text-gray-600 leading-relaxed whitespace-pre-line mb-8">
                                            {slide.content}
                                        </div>
                                        
                                        <div className={`mt-auto ${!slide.image ? 'mx-auto' : ''}`}>
                                            <motion.button 
                                                whileHover={{ scale: 1.05 }}
                                                whileTap={{ scale: 0.95 }}
                                                onClick={() => setShowModal(true)}
                                                className="bg-primary text-white px-8 py-3 rounded-full text-lg shadow-lg flex items-center gap-2 hover:bg-[#4a3252]"
                                            >
                                                <span>ูุซุงู ุนููู</span>
                                                <Icons.Left />
                                            </motion.button>
                                        </div>
                                    </div>

                                    {slide.image && (
                                        <div className="md:w-1/2 bg-gray-100 flex items-center justify-center p-4 border-r border-gray-200">
                                            <img src={slide.image} alt="Visual" className="max-w-full max-h-[500px] object-contain rounded-lg shadow-sm" />
                                        </div>
                                    )}
                                </motion.div>
                            </AnimatePresence>

                            <button onClick={prevSlide} className="absolute right-4 top-1/2 -translate-y-1/2 p-4 bg-white/80 rounded-full shadow-lg hover:bg-primary hover:text-white transition hidden md:block"><Icons.Right /></button>
                            <button onClick={nextSlide} className="absolute left-4 top-1/2 -translate-y-1/2 p-4 bg-white/80 rounded-full shadow-lg hover:bg-primary hover:text-white transition hidden md:block"><Icons.Left /></button>
                        </div>

                        <div className="flex items-center justify-center gap-4 py-4 bg-gray-50 border-t">
                            <span className="text-sm text-gray-600 font-medium">ุงูุดุฑูุญุฉ {currentSlideIndex + 1} ูู {slides.length}</span>
                            <div className="h-2 bg-gray-200 flex-1">
                                <motion.div 
                                    className="h-full bg-secondary" 
                                    initial={{ width: 0 }}
                                    animate={{ width: `${progress}%` }}
                                />
                            </div>
                        </div>

                        <AnimatePresence>
                            {showModal && (
                                <div className="fixed inset-0 bg-primary/90 z-[100] flex items-center justify-center p-4 backdrop-blur-sm" onClick={() => setShowModal(false)}>
                                    <motion.div 
                                        initial={{ opacity: 0, scale: 0.8, y: 50 }}
                                        animate={{ opacity: 1, scale: 1, y: 0 }}
                                        exit={{ opacity: 0, scale: 0.8, y: 50 }}
                                        className="bg-white w-full max-w-lg rounded-2xl p-8 shadow-2xl relative text-center"
                                        onClick={(e) => e.stopPropagation()}
                                    >
                                        <button onClick={() => setShowModal(false)} className="absolute top-4 left-4 text-gray-400 hover:text-red-500"><Icons.Close /></button>
                                        <h2 className="text-3xl font-bold text-primary mb-4">{slide.modalTitle}</h2>
                                        <div className="text-lg text-gray-600 bg-gray-50 p-4 rounded-xl border-r-4 border-secondary max-h-96 overflow-y-auto">
                                            {slide.modalContent}
                                        </div>
                                    </motion.div>
                                </div>
                            )}
                        </AnimatePresence>
                    </div>
                );
            }

            return (
                <div className="min-h-screen p-8 max-w-5xl mx-auto">
                    <header className="flex justify-between items-center mb-8">
                        <div>
                            <h1 className="text-3xl font-black text-primary">ููุญุฉ ุงูุชุญูู</h1>
                            <p className="text-gray-500">ูู ุจุฅุนุฏุงุฏ ุงูุดุฑุงุฆุญ ุซู ุงุจุฏุฃ ุงูุนุฑุถ</p>
                        </div>
                        <div className="flex gap-3">
                            <button 
                                onClick={() => setShowHelp(true)} 
                                className="bg-gray-600 text-white font-bold px-6 py-3 rounded-xl shadow-lg hover:bg-gray-700 flex items-center gap-2"
                                title="ููููุฉ ุงูุงุณุชุฎุฏุงู"
                            >
                                <Icons.Help /> ุงูุงุณุชุฎุฏุงู
                            </button>
                            <button 
                                onClick={() => downloadPresentation()} 
                                className="bg-blue-600 text-white font-bold px-6 py-3 rounded-xl shadow-lg hover:bg-blue-700 flex items-center gap-2"
                            >
                                <Icons.Download /> ุชูุฒูู ุงูุนุฑุถ
                            </button>
                            <button 
                                onClick={() => setMode('presentation')} 
                                className="bg-secondary text-primary font-bold px-6 py-3 rounded-xl shadow-lg hover:brightness-110 flex items-center gap-2"
                            >
                                <Icons.Play /> ุงุจุฏุฃ ุงูุนุฑุถ
                            </button>
                        </div>
                    </header>

                    <div className="space-y-6">
                        {slides.map((slide, index) => (
                            <motion.div layout key={slide.id} className="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                                <div className="flex justify-between items-center mb-4 border-b pb-2">
                                    <h3 className="font-bold text-lg text-primary">ุดุฑูุญุฉ {index + 1}</h3>
                                    <button onClick={() => deleteSlide(slide.id)} className="text-red-400 hover:text-red-600 p-2"><Icons.Trash /></button>
                                </div>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div className="col-span-2">
                                        <label className="block text-sm font-medium text-gray-700 mb-1">ุงูุนููุงู ุงูุฑุฆูุณู</label>
                                        <input 
                                            type="text" 
                                            value={slide.title} 
                                            onChange={(e) => updateSlide(slide.id, 'title', e.target.value)}
                                            className="w-full p-2 border rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"
                                        />
                                    </div>

                                    <div className="col-span-2">
                                        <label className="block text-sm font-medium text-gray-700 mb-1">ุงูููุงุท (ูุญุชูู ุงูุดุฑูุญุฉ)</label>
                                        <textarea 
                                            rows="3"
                                            value={slide.content} 
                                            onChange={(e) => updateSlide(slide.id, 'content', e.target.value)}
                                            className="w-full p-2 border rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"
                                        ></textarea>
                                    </div>

                                    <div className="col-span-2">
                                        <label className="block text-sm font-medium text-gray-700 mb-1">ุฑุงุจุท ุงูุตูุฑุฉ (ุงุชุฑูู ูุงุฑุบุงู ูููุต ููุท)</label>
                                        <input 
                                            type="text" 
                                            placeholder="https://..."
                                            value={slide.image} 
                                            onChange={(e) => updateSlide(slide.id, 'image', e.target.value)}
                                            className="w-full p-2 border rounded-lg focus:ring-2 focus:ring-primary focus:outline-none text-left"
                                            dir="ltr"
                                        />
                                    </div>

                                    <div className="col-span-2">
                                        <label className="block text-sm font-medium text-gray-700 mb-1">ุงุฎุชุฑ ุฃููููุฉ ููุดุฑูุญุฉ</label>
                                        <div className="grid grid-cols-4 md:grid-cols-7 gap-2">
                                            {HeroiconsList.map((iconItem) => (
                                                <button 
                                                    key={iconItem.id}
                                                    onClick={() => updateSlide(slide.id, 'slideIcon', iconItem.id)}
                                                    className={`p-3 rounded-lg transition border-2 ${slide.slideIcon === iconItem.id ? 'bg-secondary text-primary border-secondary' : 'bg-white text-gray-400 border-gray-200 hover:border-secondary hover:text-secondary'}`}
                                                    title={iconItem.name}
                                                >
                                                    {React.createElement(Icons[iconItem.icon], { size: 20 })}
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    <div className="bg-gray-50 p-4 rounded-xl col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div className="col-span-2 text-xs font-bold text-secondary uppercase tracking-widest">ุจูุงูุงุช ุงููุซุงู ุงูุนููู (ุงููุงูุฐุฉ)</div>
                                        <div>
                                            <input 
                                                type="text" 
                                                placeholder="ุนููุงู ุงููุงูุฐุฉ"
                                                value={slide.modalTitle} 
                                                onChange={(e) => updateSlide(slide.id, 'modalTitle', e.target.value)}
                                                className="w-full p-2 border rounded-lg"
                                            />
                                        </div>
                                        <div>
                                            <input 
                                                type="text" 
                                                placeholder="ูุต ุงููุซุงู..."
                                                value={slide.modalContent} 
                                                onChange={(e) => updateSlide(slide.id, 'modalContent', e.target.value)}
                                                className="w-full p-2 border rounded-lg"
                                            />
                                        </div>
                                    </div>
                                </div>
                            </motion.div>
                        ))}

                        <button 
                            onClick={addNewSlide}
                            className="w-full py-4 border-2 border-dashed border-gray-300 rounded-2xl text-gray-500 hover:border-primary hover:text-primary transition flex justify-center items-center gap-2"
                        >
                            <Icons.Plus /> ุฅุถุงูุฉ ุดุฑูุญุฉ ุฌุฏูุฏุฉ
                        </button>
                    </div>

                    {showHelp && (
                        <AnimatePresence>
                            <motion.div 
                                initial={{ opacity: 0 }}
                                animate={{ opacity: 1 }}
                                exit={{ opacity: 0 }}
                                className="fixed inset-0 bg-black/50 z-[200] flex items-center justify-center p-4"
                                onClick={() => setShowHelp(false)}
                            >
                                <motion.div 
                                    initial={{ opacity: 0, scale: 0.9, y: 20 }}
                                    animate={{ opacity: 1, scale: 1, y: 0 }}
                                    exit={{ opacity: 0, scale: 0.9, y: 20 }}
                                    className="bg-white rounded-3xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-y-auto"
                                    onClick={(e) => e.stopPropagation()}
                                >
                                    <div className="sticky top-0 bg-gradient-to-r from-primary to-[#4a3252] text-white p-6 flex justify-between items-center">
                                        <h2 className="text-2xl font-black">๐ ููููุฉ ุงูุงุณุชุฎุฏุงู</h2>
                                        <button onClick={() => setShowHelp(false)} className="hover:opacity-75 transition"><Icons.Close /></button>
                                    </div>
                                    
                                    <div className="p-8 space-y-8">
                                        <div className="flex gap-4">
                                            <div className="flex-shrink-0">
                                                <div className="flex items-center justify-center h-10 w-10 rounded-lg bg-secondary text-primary font-bold">1</div>
                                            </div>
                                            <div>
                                                <h3 className="text-lg font-bold text-primary mb-2">ุฃุถู ุฃู ุนุฏูู ุงูุดุฑุงุฆุญ</h3>
                                                <p className="text-gray-600">ูู ููุญุฉ ุงูุชุญูู ุฃุณูู ุงูุดุงุดุฉุ ููููู ุฅุถุงูุฉ ุดุฑุงุฆุญ ุฌุฏูุฏุฉ ุฃู ุชุนุฏูู ุงูุดุฑุงุฆุญ ุงูููุฌูุฏุฉ. ููู ุดุฑูุญุฉ ุนููุงู ููุญุชูู ูุฑุงุจุท ุตูุฑุฉ (ุงุฎุชูุงุฑู).</p>
                                            </div>
                                        </div>

                                        <div className="flex gap-4">
                                            <div className="flex-shrink-0">
                                                <div className="flex items-center justify-center h-10 w-10 rounded-lg bg-secondary text-primary font-bold">2</div>
                                            </div>
                                            <div>
                                                <h3 className="text-lg font-bold text-primary mb-2">ุงุฎุชุฑ ุฃููููุฉ ููู ุดุฑูุญุฉ</h3>
                                                <p className="text-gray-600">ูู ูู ุดุฑูุญุฉุ ุณุชุฌุฏ ุดุจูุฉ ุฃููููุงุช (ูุฌูุฉุ ูููุ ูุฑููุ ุฅูุฎ). ุงุฎุชุฑ ุงูุฃููููุฉ ุงูุชู ุชูุงุณุจ ูุญุชูู ุดุฑูุญุชู. ุงูุฃููููุฉ ุณุชุธูุฑ ุจุงุฑุฒุฉ ูู ุงูุนุฑุถ.</p>
                                            </div>
                                        </div>

                                        <div className="flex gap-4">
                                            <div className="flex-shrink-0">
                                                <div className="flex items-center justify-center h-10 w-10 rounded-lg bg-secondary text-primary font-bold">3</div>
                                            </div>
                                            <div>
                                                <h3 className="text-lg font-bold text-primary mb-2">ุฃุถู ูุซุงูุงู ุนูููุงู (ุงุฎุชูุงุฑู)</h3>
                                                <p className="text-gray-600">ูู ุฃุณูู ูู ุดุฑูุญุฉุ ููููู ุฅุถุงูุฉ ุนููุงู ููุต ูููุซุงู ุงูุนููู. ุนูุฏูุง ูุถุบุท ุงููุดุงูุฏ ุนูู ุฒุฑ "ูุซุงู ุนููู" ูู ุงูุนุฑุถุ ุณูุธูุฑ ุตูุฏูู ุจุชูุงุตูู ุงููุซุงู.</p>
                                            </div>
                                        </div>

                                        <div className="flex gap-4">
                                            <div className="flex-shrink-0">
                                                <div className="flex items-center justify-center h-10 w-10 rounded-lg bg-secondary text-primary font-bold">4</div>
                                            </div>
                                            <div>
                                                <h3 className="text-lg font-bold text-primary mb-2">ุงุจุฏุฃ ุงูุนุฑุถ</h3>
                                                <p className="text-gray-600">ุงุถุบุท ุนูู ุฒุฑ "ุงุจุฏุฃ ุงูุนุฑุถ" ูุนุฑุถ ุดุฑุงุฆุญู ูู ูุถุน ุงูุนุฑุถ ุงูุชูุฏููู. ุงุณุชุฎุฏู ุฃุฒุฑุงุฑ ุงูุชููู ุฃู ุฃุณูู ููุญุฉ ุงูููุงุชูุญ ููุงูุชูุงู ุจูู ุงูุดุฑุงุฆุญ.</p>
                                            </div>
                                        </div>

                                        <div className="flex gap-4">
                                            <div className="flex-shrink-0">
                                                <div className="flex items-center justify-center h-10 w-10 rounded-lg bg-secondary text-primary font-bold">5</div>
                                            </div>
                                            <div>
                                                <h3 className="text-lg font-bold text-primary mb-2">ูุฒูู ุงูุนุฑุถ</h3>
                                                <p className="text-gray-600">ุงุถุบุท ุนูู "ุชูุฒูู ุงูุนุฑุถ" ูุญูุธ ุงูุนุฑุถ ูููู HTML. ููููู ุงุณุชุฎุฏุงู ูุฐุง ุงูููู ูู ุฃู ููุงู ูุฃู ููุช ุฏูู ุงูุญุงุฌุฉ ููุฅูุชุฑูุช.</p>
                                            </div>
                                        </div>

                                        <div className="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                                            <h4 className="font-bold text-blue-900 mb-2">๐ก ูุตุงุฆุญ ูููุฏุฉ:</h4>
                                            <ul className="text-sm text-blue-800 space-y-2">
                                                <li>โข ุงุณุชุฎุฏู ุฃุณูู ููุญุฉ ุงูููุงุชูุญ (โ โ) ููุชููู ุจูู ุงูุดุฑุงุฆุญ</li>
                                                <li>โข ุงุถุบุท ESC ูุฅุบูุงู ุงููุซุงู ุงูุนููู ูุงูุนูุฏุฉ ููุดุฑูุญุฉ</li>
                                                <li>โข ุดุฑูุท ุงูุชูุฏู ุฃุณูู ุงูุดุงุดุฉ ููุถุญ ูููุนู ูู ุงูุนุฑุถ</li>
                                                <li>โข ุงูุตูุฑ ุงุฎุชูุงุฑูุฉ - ููููู ุฅูุดุงุก ุนุฑูุถ ูุตูุฉ ููุท</li>
                                            </ul>
                                        </div>
                                    </div>
                                </motion.div>
                            </motion.div>
                        </AnimatePresence>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
