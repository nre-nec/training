<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>منشئ العروض التفاعلية — Dynamic Slide Deck Builder</title>

  <!-- Cairo Font -->
  <!DOCTYPE html>
  <html lang="ar" dir="rtl">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>منشئ العروض التقديمية - كلية الشمال</title>
    
      <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
      <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
      <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
      <script src="https://cdn.tailwindcss.com"></script>
    
      <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>

      <style>
          /* خط Cairo */
          @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap');
        
          body { font-family: 'Cairo', sans-serif; background-color: #f3f4f6; }
        
          /* ألوان مخصصة */
          .text-primary { color: #5D4068; }
          .bg-primary { background-color: #5D4068; }
          .text-secondary { color: #C5B358; }
          .bg-secondary { background-color: #C5B358; }
          .border-primary { border-color: #5D4068; }
        
          /* إخفاء شريط التمرير */
          .no-scrollbar::-webkit-scrollbar { display: none; }
          .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
      </style>
  </head>
  <body>
      <div id="root"></div>

      <script type="text/babel">
          /************************************************
           * 1. تهيئة المكتبات (الجزء الأهم لتجنب الأخطاء)
           ************************************************/
          const { useState, useEffect, useRef } = React;
        
          // استدعاء Framer Motion من النافذة مباشرة
          const { motion, AnimatePresence } = window.Motion;

          // أيقونات SVG مدمجة لتجنب مشاكل المكتبات الخارجية
          const Icons = {
              Plus: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>,
              Trash: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>,
              Play: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>,
              Edit: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>,
              Close: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
              Right: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m9 18 6-6-6-6"/></svg>,
              Left: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m15 18-6-6 6-6"/></svg>,
              Image: () => <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>
          };

          /************************************************
           * 2. البيانات الأولية (نموذج)
           ************************************************/
          const initialSlides = [
              {
                  id: 1,
                  title: "رؤية الكلية والتميز",
                  content: "• الريادة في تقديم تعليم تمريضي مبتكر.\n• تخريج كوادر وطنية مؤهلة.\n• بيئة تعليمية محفزة.",
                  image: "", // اتركها فارغة لتجربة النص الكامل
                  modalTitle: "قصة نجاح",
                  modalContent: "تم تخريج 300 طالب وطالبة هذا العام بنسبة توظيف بلغت 95%."
              },
              {
                  id: 2,
                  title: "الإحصائيات والأرقام",
                  content: "• نسبة رضا الطلاب: 98%\n• عدد الشراكات: 15 مستشفى\n• الاعتمادات: 3 اعتمادات دولية",
                  image: "https://placehold.co/600x400/5D4068/FFF?text=Chart", 
                  modalTitle: "تفاصيل الرسم البياني",
                  modalContent: "يوضح الرسم البياني النمو المتصاعد في أعداد المقبولين."
              }
          ];

          /************************************************
           * 3. مكون التطبيق الرئيسي (App Component)
           ************************************************/
          function App() {
              const [mode, setMode] = useState('editor'); // 'editor' or 'presentation'
              const [slides, setSlides] = useState(initialSlides);
              const [currentSlideIndex, setCurrentSlideIndex] = useState(0);
              const [showModal, setShowModal] = useState(false);

              // --- دوال التحكم ---
              const addNewSlide = () => {
                  const newId = slides.length + 1;
                  setSlides([...slides, { 
                      id: newId, 
                      title: "شريحة جديدة", 
                      content: "اكتب النقاط هنا...", 
                      image: "", 
                      modalTitle: "عنوان المثال", 
                      modalContent: "تفاصيل المثال..." 
                  }]);
              };

              const updateSlide = (id, field, value) => {
                  setSlides(slides.map(s => s.id === id ? { ...s, [field]: value } : s));
              };

              const deleteSlide = (id) => {
                  if (slides.length > 1) {
                      setSlides(slides.filter(s => s.id !== id));
                  }
              };

              const nextSlide = () => {
                  if (currentSlideIndex < slides.length - 1) setCurrentSlideIndex(prev => prev + 1);
                  else setCurrentSlideIndex(0); // Loop
              };

              const prevSlide = () => {
                  if (currentSlideIndex > 0) setCurrentSlideIndex(prev => prev - 1);
                  else setCurrentSlideIndex(slides.length - 1);
              };

              // دعم لوحة المفاتيح
              useEffect(() => {
                  const handleKeyDown = (e) => {
                      if (mode === 'presentation') {
                          if (e.key === 'ArrowLeft') nextSlide(); // RTL منطق
                          if (e.key === 'ArrowRight') prevSlide();
                          if (e.key === 'Escape') setMode('editor');
                      }
                  };
                  window.addEventListener('keydown', handleKeyDown);
                  return () => window.removeEventListener('keydown', handleKeyDown);
              }, [mode, currentSlideIndex]);

              // --- واجهة العرض (Presentation Mode) ---
              if (mode === 'presentation') {
                  const slide = slides[currentSlideIndex];
                  const progress = ((currentSlideIndex + 1) / slides.length) * 100;

                  return (
                      <div className="relative w-full h-screen overflow-hidden bg-white flex flex-col">
                          {/* شعار ثابت */}
                          <img src="https://nre-nec.github.io/pictures/logo.png" alt="Logo" className="fixed top-5 left-5 w-24 z-50 drop-shadow-md" />
                        
                          {/* زر الخروج */}
                          <button onClick={() => setMode('editor')} className="fixed top-5 right-5 z-50 bg-gray-200 p-2 rounded-full hover:bg-gray-300">
                              <Icons.Edit />
                          </button>

                          {/* منطقة الشريحة */}
                          <div className="flex-1 flex items-center justify-center p-4 relative">
                              <AnimatePresence mode="wait">
                                  <motion.div 
                                      key={slide.id}
                                      initial={{ opacity: 0, x: 50 }}
                                      animate={{ opacity: 1, x: 0 }}
                                      exit={{ opacity: 0, x: -50 }}
                                      transition={{ duration: 0.5 }}
                                      className={`w-full max-w-6xl bg-white rounded-3xl shadow-2xl overflow-hidden border-t-8 border-primary flex flex-col md:flex-row ${!slide.image ? 'md:grid-cols-1' : ''}`}
                                      style={{ minHeight: '70vh' }}
                                  >
                                      {/* النص */}
                                      <div className={`p-10 flex flex-col justify-center ${slide.image ? 'md:w-1/2' : 'w-full text-center'}`}>
                                          <div className="mb-6">
                                              <span className="text-secondary text-4xl">✦</span>
                                              <h1 className="text-4xl md:text-5xl font-black text-primary mt-2">{slide.title}</h1>
                                          </div>
                                          <div className="text-xl md:text-2xl text-gray-600 leading-relaxed whitespace-pre-line mb-8">
                                              {slide.content}
                                          </div>
                                        
                                          <div className={`mt-auto ${!slide.image ? 'mx-auto' : ''}`}>
                                              <motion.button 
                                                  whileHover={{ scale: 1.05 }}
                                                  whileTap={{ scale: 0.95 }}
                                                  onClick={() => setShowModal(true)}
                                                  className="bg-primary text-white px-8 py-3 rounded-full text-lg shadow-lg flex items-center gap-2 hover:bg-[#4a3252]"
                                              >
                                                  <span>مثال عملي</span>
                                                  <Icons.Left />
                                              </motion.button>
                                          </div>
                                      </div>

                                      {/* الصورة */}
                                      {slide.image && (
                                          <div className="md:w-1/2 bg-gray-100 flex items-center justify-center p-4 border-r border-gray-200">
                                              <img src={slide.image} alt="Visual" className="max-w-full max-h-[500px] object-contain rounded-lg shadow-sm" />
                                          </div>
                                      )}
                                  </motion.div>
                              </AnimatePresence>

                              {/* أزرار التنقل */}
                              <button onClick={prevSlide} className="absolute right-4 top-1/2 -translate-y-1/2 p-4 bg-white/80 rounded-full shadow-lg hover:bg-primary hover:text-white transition hidden md:block"><Icons.Right /></button>
                              <button onClick={nextSlide} className="absolute left-4 top-1/2 -translate-y-1/2 p-4 bg-white/80 rounded-full shadow-lg hover:bg-primary hover:text-white transition hidden md:block"><Icons.Left /></button>
                          </div>

                          {/* شريط التقدم */}
                          <div className="h-2 bg-gray-200 w-full">
                              <motion.div 
                                  className="h-full bg-secondary" 
                                  initial={{ width: 0 }}
                                  animate={{ width: `${progress}%` }}
                              />
                          </div>

                          {/* النافذة المنبثقة (Modal) */}
                          <AnimatePresence>
                              {showModal && (
                                  <div className="fixed inset-0 bg-primary/90 z-[100] flex items-center justify-center p-4 backdrop-blur-sm" onClick={() => setShowModal(false)}>
                                      <motion.div 
                                          initial={{ opacity: 0, scale: 0.8, y: 50 }}
                                          animate={{ opacity: 1, scale: 1, y: 0 }}
                                          exit={{ opacity: 0, scale: 0.8, y: 50 }}
                                          className="bg-white w-full max-w-lg rounded-2xl p-8 shadow-2xl relative text-center"
                                          onClick={(e) => e.stopPropagation()}
                                      >
                                          <button onClick={() => setShowModal(false)} className="absolute top-4 left-4 text-gray-400 hover:text-red-500"><Icons.Close /></button>
                                          <h2 className="text-3xl font-bold text-primary mb-4">{slide.modalTitle}</h2>
                                          <div className="text-lg text-gray-600 bg-gray-50 p-4 rounded-xl border-r-4 border-secondary">
                                              {slide.modalContent}
                                          </div>
                                      </motion.div>
                                  </div>
                              )}
                          </AnimatePresence>
                      </div>
                  );
              }

              // --- واجهة المحرر (Editor Mode) ---
              return (
                  <div className="min-h-screen p-8 max-w-5xl mx-auto">
                      <header className="flex justify-between items-center mb-8">
                          <div>
                              <h1 className="text-3xl font-black text-primary">لوحة التحكم</h1>
                              <p className="text-gray-500">قم بإعداد الشرائح ثم ابدأ العرض</p>
                          </div>
                          <button 
                              onClick={() => setMode('presentation')} 
                              className="bg-secondary text-primary font-bold px-6 py-3 rounded-xl shadow-lg hover:brightness-110 flex items-center gap-2"
                          >
                              <Icons.Play /> ابدأ العرض
                          </button>
                      </header>

                      <div className="space-y-6">
                          {slides.map((slide, index) => (
                              <motion.div layout key={slide.id} className="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                                  <div className="flex justify-between items-center mb-4 border-b pb-2">
                                      <h3 className="font-bold text-lg text-primary">شريحة {index + 1}</h3>
                                      <button onClick={() => deleteSlide(slide.id)} className="text-red-400 hover:text-red-600 p-2"><Icons.Trash /></button>
                                  </div>
                                
                                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                      {/* العنوان */}
                                      <div className="col-span-2">
                                          <label className="block text-sm font-medium text-gray-700 mb-1">العنوان الرئيسي</label>
                                          <input 
                                              type="text" 
                                              value={slide.title} 
                                              onChange={(e) => updateSlide(slide.id, 'title', e.target.value)}
                                              className="w-full p-2 border rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"
                                          />
                                      </div>

                                      {/* المحتوى */}
                                      <div className="col-span-2">
                                          <label className="block text-sm font-medium text-gray-700 mb-1">النقاط (محتوى الشريحة)</label>
                                          <textarea 
                                              rows="3"
                                              value={slide.content} 
                                              onChange={(e) => updateSlide(slide.id, 'content', e.target.value)}
                                              className="w-full p-2 border rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"
                                          ></textarea>
                                      </div>

                                      {/* رابط الصورة */}
                                      <div className="col-span-2">
                                          <label className="block text-sm font-medium text-gray-700 mb-1">رابط الصورة (اتركه فارغاً للنص فقط)</label>
                                          <input 
                                              type="text" 
                                              placeholder="https://..."
                                              value={slide.image} 
                                              onChange={(e) => updateSlide(slide.id, 'image', e.target.value)}
                                              className="w-full p-2 border rounded-lg focus:ring-2 focus:ring-primary focus:outline-none text-left"
                                              dir="ltr"
                                          />
                                      </div>

                                      {/* بيانات النافذة المنبثقة */}
                                      <div className="bg-gray-50 p-4 rounded-xl col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4">
                                          <div className="col-span-2 text-xs font-bold text-secondary uppercase tracking-widest">بيانات المثال العملي (النافذة)</div>
                                          <div>
                                              <input 
                                                  type="text" 
                                                  placeholder="عنوان النافذة"
                                                  value={slide.modalTitle} 
                                                  onChange={(e) => updateSlide(slide.id, 'modalTitle', e.target.value)}
                                                  className="w-full p-2 border rounded-lg"
                                              />
                                          </div>
                                          <div>
                                              <input 
                                                  type="text" 
                                                  placeholder="نص المثال..."
                                                  value={slide.modalContent} 
                                                  onChange={(e) => updateSlide(slide.id, 'modalContent', e.target.value)}
                                                  className="w-full p-2 border rounded-lg"
                                              />
                                          </div>
                                      </div>
                                  </div>
                              </motion.div>
                          ))}

                          <button 
                              onClick={addNewSlide}
                              className="w-full py-4 border-2 border-dashed border-gray-300 rounded-2xl text-gray-500 hover:border-primary hover:text-primary transition flex justify-center items-center gap-2"
                          >
                              <Icons.Plus /> إضافة شريحة جديدة
                          </button>
                      </div>
                  </div>
              );
          }

          const root = ReactDOM.createRoot(document.getElementById('root'));
          root.render(<App />);
      </script>
  </body>
  </html>
